---
title: Creating Sandboxes
description: Learn how to create sandboxes with the CodeSandbox SDK.
---

import { Callout } from 'nextra-theme-docs'

# Creating Sandboxes

Sandboxes are the main building blocks of the CodeSandbox SDK. Each one represents an isolated development environment that can be run in a virtual machine, forked, and modified. Every Sandbox is backed by a Firecracker VM and is completely isolated and persisted, providing you with a secure environment to run untrusted code.

## Creating a Sandbox

Once you have [created a template](sdk/templates) using the CLI, you can use its template ID to create sandboxes. The template ID is returned when you successfully build a template.

```ts
import { CodeSandbox } from '@codesandbox/sdk'

const sdk = new CodeSandbox();

// Create a sandbox from your custom template
const sandbox = await sdk.sandboxes.create({
  id: 'your-template-id-here'
});
```

<Callout>
By default, Sandboxes are `public-hosts`. Available privacy options:
- `public`: Sandbox and hosts are publicly accessible
- `private`: Sandbox is private, hosts require tokens 
- `public-hosts`: Sandbox is private, but hosts are publicly accessible
</Callout>

```ts
const sandbox = await sdk.sandboxes.create({
    // The template id
    id: 'your-custom-template-id',

    // Optional properties
    title: 'my-sandbox',
    description: 'My sandbox',
    tags: ['my-tag'],

    // Privacy options: 'public', 'private', or 'public-hosts'
    privacy: 'public-hosts',

    // Collection folder on Dashboard
    path: '/users/some-user-folder',

    // What VM Tier to use for the Sandbox
    vmTier: VMTier.Micro,

    // How quickly the sandbox should hibernate after inactivity. Set
    // this field to the maximum 24 hours (See deprecation below)
    hibernationTimeoutSeconds: 86400,

    // Configure if Sandbox should wake up automatically on HTTP
    // or requests or WebSocket connections. Set both of these to `false`
    // (See deprecation below)
    automaticWakeupConfig: {
        http: false,
        websocket: false
    }
})
```

<Callout type="warning">
Both `hibernationTimeoutSeconds` and `wakeupConfig` have been deprecated. Manual lifecycle management is required to scale, control costs, and create a predictable user experience. These features will not be available in the next major version.
</Callout>

Each Sandbox has the following properties, with information about its own instance:

- `id`: The unique identifier of the sandbox.
- `isUpToDate`: Whether the sandbox is up to date with the latest agent version.
- `cluster`: The cluster the sandbox is running on.
- `bootupType`: The type of bootup, `RUNNING`, `CLEAN`, `RESUME` or `FORK`.

## Create a Sandbox from a Sandbox

You can create a Sandbox by referencing the `id` of an existing Sandbox:

```ts
const sandbox = await sdk.sandboxes.create({
  id: 'some-sandbox-id'
})
```

Ensure the parent Sandbox is in a `HIBERNATED` state before performing this operation.

<Callout type="warning">
Depending on the state of the parent Sandbox:

- **RUNNING**: This creates what we call a "Live Fork", which is limited to 5. The created Sandboxes will share memory with the parent and can cause a degraded experience
- **ARCHIVED**: The parent Sandbox first needs to be resumed, which can take 10-60 seconds, causing the creation to take a long time

</Callout>

## Workspace

Every sandbox comes with a workspace that provides persistent storage and configuration for your project. The workspace is located at `/project/workspace` and serves as the main working directory for your code and files.

<Callout>
There is also a `/project/sandbox` folder, but consider this deprecated. Use `/project/workspace` for all new projects.
</Callout>

The primary persistence mechanism is based on git with a local remote. This means the workspace is initialized with git automatically.

<Callout type="warning">
Running git commands in the workspace without setting a new remote will cause issues with persistence.
</Callout>

### Using git in the root workspace

```bash
# Remove the default local remote and add your own
git remote remove origin
git remote add origin https://github.com/your-username/your-repo.git

# Now you can push/pull normally
git push -u origin main
```

### Using git as a submodule

```bash
# Clone your repository inside the workspace
cd /project/workspace
git clone https://github.com/your-username/your-repo.git my-project
cd my-project

# Work normally within the cloned repository
git add .
git commit -m "Your changes"
git push
```

This approach ensures your work is properly persisted and archived when necessary.

## Connect

Establishes a connection to the sandbox and returns a client for interacting with it:

```ts
const sandbox = await sdk.sandboxes.create({
  id: 'your-template-id'
});
const client = await sandbox.connect();
```

## Create a session

Creates a session you can pass to browser/node clients.

```ts
const sandbox = await sdk.sandboxes.create({
  id: 'your-template-id'
});
const session = await sandbox.createSession();
```

## Update tier

Updates the VM tier of the running sandbox:

```ts
import { VMTier } from '@codesandbox/sdk';

const sandbox = await sdk.sandboxes.resume('some-sandbox-id');

// Upgrade to a more powerful VM tier
await sandbox.updateTier(VMTier.Small);
```

<Callout type="warning">
You can only upgrade to higher VM tiers than the initial one.
</Callout>

## âš¡ Best practices

- **Be careful when creating a Sandbox from a Sandbox** - Creating from a running or archived Sandbox can degrade performance. If your product requires this, you will need long-term persistence.
- **Avoid VM tier downsizing** - Set the minimum tier needed for your templates and never downsize the tier of a Sandbox created from a template or other Sandboxes.
